# Материалы и методы

В клинике РУМ с сентября 2025 г. по январь 2026 г. нами было проведено комплексное обследование 67 пациентов в возрасте 35-55 лет, среди которых 39 женщин и 28 мужчин. У большинства пациентов при осмотре были выявлены признаки патологической стираемости жевательной группы зубов лёгкой, средней или тяжёлой степени. После проведения анализа жевательной и височной группы мышц при помощи аппарата диагностической системы BjoEMG II (BioPAK Inc., США) необходимые данные были загружены в автоматизированную ИИ-систему «ComposeAI — ИИ-система выбора композита для реставрации жевательных зубов».

Для разработки системы использован язык программирования Python версии 3.9 и выше, обеспечивающий доступ к библиотекам для обработки данных, машинного обучения и работы с научными публикациями. Веб-интерфейс реализован с использованием фреймворка Streamlit, позволяющего создавать интерактивные веб-приложения с минимальным количеством кода. Для реализации алгоритмов машинного обучения использована библиотека scikit-learn, включающая алгоритмы Random Forest (случайный лес) и Gradient Boosting (градиентный бустинг). Обработка данных осуществлялась с помощью библиотек pandas (для работы с табличными данными) и numpy (для численных вычислений). Для извлечения текста из научных публикаций в формате PDF использовались библиотеки PyPDF2 и pdfplumber.

Система спроектирована с использованием модульной архитектуры. Основной веб-интерфейс реализован в модуле `app/app.py`, который координирует работу остальных компонентов. Модуль нормализации ЭМГ-данных (`Код_нормализации_ЭМГ.py`) обеспечивает приведение показателей с разных аппаратов к единой шкале на основе метода приведения к контрольным значениям. Для каждого аппарата из научной литературы определены эталонные (контрольные) значения для здоровых пациентов, которые используются как точка отсчета для нормализации: показатели конкретного пациента приводятся к единой шкале путем умножения на коэффициент, равный отношению контрольного значения эталонного аппарата (Synapsys) к контрольному значению используемого аппарата. Модуль выбора композита (`composite_selector.py`) содержит основную логику ранжирования и фильтрации материалов. Модуль извлечения знаний (`knowledge_extractor.py`) анализирует научные статьи и извлекает релевантную информацию. Модуль обучения модели (`model_trainer.py`) отвечает за подготовку данных и обучение алгоритмов машинного обучения.

Изначально база данных содержала информацию о 20 наиболее распространенных композитных материалах. В процессе разработки база была расширена до 180+ композитов из различных регионов и производителей: США (3M ESPE, Dentsply Sirona, Kerr), Европы (Ivoclar Vivadent, VOCO, Septodont, GC Corporation), России (Омега Дент, СтомаДент), Азии (Shofu, Kuraray Noritake) и Италии (Micerium, Polydentia). Для каждого композита в базе хранятся следующие характеристики: микротвердость (в единицах KHN — число твердости по Кнупу), полимеризационная усадка (в процентах), содержание наполнителя (в процентах), износостойкость (качественная оценка: низкая, средняя, высокая, очень высокая), глубина полимеризации (в миллиметрах), вязкость, тип матрицы, год выпуска на рынок и цена на российском рынке.

Система использует алгоритм выбора композита, основанный на взвешенной оценке характеристик с применением правил, извлеченных из научных публикаций. Первое правило гласит, что для реставрации жевательных зубов должны исключаться композиты с полимеризационной усадкой более 3%, так как высокая усадка может привести к нарушению краевого прилегания и развитию вторичного кариеса. Второе правило основано на исследовании влияния концентрации наполнителя на механизмы износа: оптимальным считается диапазон 25-50% наполнителя по массе, при котором материал демонстрирует наилучшее сочетание прочности и устойчивости к износу. Для обеспечения клинической применимости разработана многоуровневая система ранжирования: композиты, строго соответствующие обоим правилам (усадка ≤3% и наполнитель 25-50%), получают статус "Приоритетный вариант", а композиты с наполнителем 55-70%, соответствующие первому правилу, предлагаются как "Альтернативный вариант" с соответствующим обоснованием.

Для автоматического извлечения знаний из научных статей разработан модуль `KnowledgeExtractor` (извлекатель знаний). Этот модуль анализирует текст статьи, используя методы обработки естественного языка, и извлекает следующие типы информации: рекомендации по использованию конкретных композитов, интерпретацию ЭМГ-показателей, клинические критерии выбора материалов, технические характеристики композитов, упомянутые в публикациях. Для извлечения текста из PDF-файлов используются библиотеки PyPDF2 и pdfplumber, что обеспечивает надежную обработку различных форматов PDF-документов. Для обеспечения непрерывности работы системы реализована функция сохранения загруженных статей между сессиями. Все загруженные статьи (как в виде текста, так и в формате PDF) сохраняются в структурированном формате JSON (JavaScript Object Notation — текстовый формат для хранения структурированных данных), что позволяет системе использовать ранее загруженные материалы при последующих запусках.

Для подготовки данных для обучения алгоритмов машинного обучения разработан модуль `model_trainer.py` (обучатель модели). Этот модуль автоматически извлекает из научных статей пары "ЭМГ-данные → рекомендованный композит", создавая структурированный набор данных для обучения. Для обучения использовались два алгоритма: Random Forest (случайный лес — ансамбль решающих деревьев) и Gradient Boosting (градиентный бустинг — последовательное обучение слабых моделей). Оба алгоритма настроены с использованием техники балансировки классов, что важно при работе с данными, где некоторые композиты представлены чаще других. Для обеспечения актуальности модели реализовано автоматическое обучение при каждом запуске приложения. Система проверяет наличие сохраненной обученной модели, и если модель отсутствует или устарела, автоматически запускает процесс обучения на доступных данных. В процессе оптимизации модели реализованы расширенный поиск статей в интернете (PubMed, arXiv), генерация синтетических обучающих данных на основе реальных паттернов, использование ансамбля моделей (комбинация нескольких алгоритмов для повышения точности).

Для создания пользовательского интерфейса выбран фреймворк Streamlit, который позволяет создавать интерактивные веб-приложения с минимальным количеством кода. Интерфейс включает форму для ввода ЭМГ-данных пациента, выбор типа классификации стираемости (классическая по Бушану М.Г. или современная TWES 2.0), дополнительные фильтры (страна производителя, компания, год выпуска, цена), и область отображения результатов в виде карточек с метриками композитов.

Для обеспечения соответствия клинической практике в систему интегрированы две классификации патологической стираемости зубов: классическая классификация по Бушану М.Г. (четыре степени, основанные на глубине стирания тканей) и современная классификация TWES 2.0 (пять градаций от 0 до 4). Каждая классификация содержит рекомендации по минимальной микротвердости, износостойкости и содержанию наполнителя для каждой степени стираемости, что позволяет системе автоматически фильтровать композиты в соответствии с клинической ситуацией.

Для обеспечения доступности системы выбран облачный сервис Streamlit Cloud, который позволяет развернуть приложение без необходимости настройки серверной инфраструктуры. Развертывание осуществлялось через платформу GitHub — систему контроля версий, которая позволяет отслеживать изменения в коде и автоматически обновлять развернутое приложение при внесении изменений. Для оптимизации производительности реализованы механизмы кэширования (сохранения в памяти часто используемых данных) загрузки базы композитов и ленивой загрузки модели машинного обучения (загрузка только при необходимости), что значительно ускоряет работу приложения и снижает нагрузку на вычислительные ресурсы.

